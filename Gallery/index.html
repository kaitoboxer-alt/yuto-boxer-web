<section id="gallery-root">
    <div class="gallery-wrapper">
        <main class="landscape-grid" id="landscape-container">
            </main>

        <aside class="vertical-sticky-area" id="vertical-container">
            </aside>
    </div>

    <div id="gallery-modal" class="modal-overlay" onclick="closeGalleryModal()">
        <div class="modal-content glass-effect" onclick="event.stopPropagation()">
            <img id="modal-image" src="" alt="Full size image">
            <div class="comment-section">
                <h2 id="modal-title" style="color: #fff; margin-bottom: 10px;">TITLE</h2>
                <p id="modal-text" style="color: #ddd; line-height: 1.6;">Comment Loading...</p>
            </div>
            <button class="close-btn" onclick="closeGalleryModal()" style="position:absolute; top:20px; right:20px; background:none; border:none; color:#fff; font-size:30px; cursor:pointer;">×</button>
        </div>
    </div>
</section>

<style>
/* ギャラリー全体のレイアウト */
.gallery-wrapper {
    display: flex;
    gap: 30px;
    padding: 40px;
    min-height: 100vh;
    background: transparent; /* 既存の背景を活かす */
}

/* 横画像エリア：3カラムのグリッド */
.landscape-grid {
    flex: 3;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 25px;
    align-content: start;
}

/* 縦画像エリア：右側に固定 */
.vertical-sticky-area {
    flex: 1;
    position: sticky;
    top: 40px;
    height: calc(100vh - 80px);
    display: flex;
    flex-direction: column;
    gap: 25px;
}

/* フロストガラス・カードデザイン */
.glass-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    padding: 12px;
    transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.glass-card img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    display: block;
}

.glass-card:hover {
    transform: translateY(-10px) scale(1.02);
    background: rgba(255, 255, 255, 0.12);
    box-shadow: 0 20px 40px rgba(0,0,0,0.5);
    border-color: rgba(255, 255, 255, 0.3);
}

/* モーダル：75%ブラック */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.75); 
    z-index: 9999;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(20px);
}

.modal-content.glass-effect {
    position: relative;
    max-width: 800px;
    width: 90%;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 24px;
    padding: 40px;
    text-align: center;
}

#modal-image {
    max-width: 100%;
    max-height: 65vh;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 0 40px rgba(0,0,0,0.6);
}
/* 1. 親要素が背景を隠さないように透明化 */
#gallery-root {
    background: transparent !important;
}

.gallery-wrapper {
    display: flex;
    gap: 30px;
    padding: 40px;
    min-height: 100vh;
    /* 背景画を透過させるために background-color を削除、または透明に */
    background: rgba(0, 0, 0, 0.4); /* 背景画を活かしつつ、文字を見やすくするために40%の薄い黒を敷く */
    backdrop-filter: none; /* ここでボカすと背景画全体がボケてしまうので注意 */
}

/* 2. もし背景画自体が消えてしまった場合、ここに元の背景パスを再設定します */
/* body {
    background-image: url('あなたの背景画像のパス');
    background-size: cover;
    background-attachment: fixed;
    background-position: center;
}
*/
</style>

<script>
// JSONのパス (GitHubのURLまたは相対パス)
// 開発中は相対パス、本番はRAW URLを推奨
const COMMENTS_JSON_PATH = 'Gallery/comments.json'; 

let galleryData = {};

// JSONを取得
async function loadComments() {
    try {
        const response = await fetch(COMMENTS_JSON_PATH);
        galleryData = await response.json();
    } catch (e) {
        console.warn("JSON load failed, using empty data.");
    }
}

function openGalleryModal(fileName, type) {
    const modal = document.getElementById('gallery-modal');
    const modalImg = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalText = document.getElementById('modal-text');

    // パス構築 (大文字小文字はディレクトリ名に合わせてください)
    const folder = type === 'landscape' ? 'Gallery/Landscape/' : 'Gallery/Vertical/';
    modalImg.src = folder + fileName;

    // JSONからデータを取得
    const data = galleryData[type] && galleryData[type][fileName];
    
    modalTitle.innerText = data ? data.title : fileName;
    modalText.innerText = data ? data.description : "No comment available.";

    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden'; // スクロール禁止
}

function closeGalleryModal() {
    document.getElementById('gallery-modal').style.display = 'none';
    document.body.style.overflow = 'auto'; // スクロール再開
}

// 初期化
loadComments();
</script>